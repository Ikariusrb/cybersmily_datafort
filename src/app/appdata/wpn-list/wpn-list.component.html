<div class="container">
  <h2>Master Weapons List</h2>
  <div>This is the master list of all weapons with their sources.
    Search is based on what the field starts with.
    Sources were pulled from R. Talsorian and the Interface magazines.</div>
  <table class="mstr-skill-table csd-rounded small">
    <tr class="csd-rounded bg-secondary text-light">
      <th class="text-center">Category
        <fa-icon [icon]="(isSorted('category'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('category')"></fa-icon>
      </th>
      <th class="text-center text-nowrap">Subcategory
        <fa-icon [icon]="(isSorted('subcategory'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('subcategory')"></fa-icon>
      </th>
      <th class="text-center">Name
        <fa-icon [icon]="(isSorted('name'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('name')"></fa-icon>
      </th>
      <th class="text-center">Type
        <fa-icon [icon]="(isSorted('type'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('type')"></fa-icon>
      </th>
      <th class="text-center text-nowrap">WA
        <fa-icon [icon]="(isSorted('wa'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('wa')"></fa-icon>
      </th>
      <th class="text-center">Conc.
        <fa-icon [icon]="(isSorted('conc'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('conc')"></fa-icon>
      </th>
      <th class="text-center">Avail.
        <fa-icon [icon]="(isSorted('avail'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('avail')"></fa-icon>
      </th>
      <th class="text-center">Damage
        <fa-icon [icon]="(isSorted('damage'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('damage')"></fa-icon>
      </th>
      <th class="text-center">Ammo
        <fa-icon [icon]="(isSorted('ammo'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('ammo')"></fa-icon>
      </th>
      <th class="text-center text-nowrap">#Shots
        <fa-icon [icon]="(isSorted('shots'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('shots')"></fa-icon>
      </th>
      <th class="text-center text-nowrap">ROF
        <fa-icon [icon]="(isSorted('rof'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('rof')"></fa-icon>
      </th>
      <th class="text-center">Rel
        <fa-icon [icon]="(isSorted('rel'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('rel')"></fa-icon>
      </th>
      <th class="text-center text-nowrap">Range
        <fa-icon [icon]="(isSorted('range'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('range')"></fa-icon>
      </th>
      <th class="text-center text-nowrap">Cost
        <fa-icon [icon]="(isSorted('cost'))?faSortUp:faSortDown" class="csd-btn" (click)="toggleSort('cost')"></fa-icon>
      </th>
      <th class="text-center">Source</th>
    </tr>
    <tr>
      <td>
        <select [(ngModel)]="filters.category" class="skill-search">
          <option [ngValue]="''">All</option>
          <option *ngFor="let category of categories" [ngValue]="category">{{
            category
          }}</option>
        </select>
      </td>
      <td><input [(ngModel)]="filters.subcategory" type="search" placeholder="search on name" class="skill-search"/></td>
      <td><input [(ngModel)]="filters.name" type="search" placeholder="search on name" class="skill-search"/></td>
      <td>
        <select [(ngModel)]="filters.type">
          <option [ngValue]="''">All</option>
            <option *ngFor="let type of weaponTypes" [ngValue]="type.code">{{
              type.code
            }}</option>
        </select>
      </td>
        <td></td>
      <td>
        <select [(ngModel)]="filters.conc">
          <option [ngValue]="''">All</option>
            <option *ngFor="let conc of concealments" [ngValue]="conc.code">{{ conc.name }}</option>
        </select>
      </td>
      <td>
        <select [(ngModel)]="filters.avail">
          <option [ngValue]="''">All</option>
            <option *ngFor="let avail of availabilities" [ngValue]="avail.code">{{ avail.name }}</option>
        </select>
      </td>
      <td>
        <input [(ngModel)]="filters.damage" type="search" placeholder="Search damage" class="skill-search"/>
      </td>
      <td>
        <input [(ngModel)]="filters.ammo" type="search" placeholder="Search ammo" class="skill-search"/>
      </td>
      <td></td>
      <td></td>
      <td>
        <select [(ngModel)]="filters.rel">
          <option [ngValue]="''" selected>All</option>
            <option *ngFor="let rel of reliabilites" [ngValue]="rel.code">{{
              rel.name
            }}</option>
        </select></td>
      <td></td>
      <td></td>
      <td><input [(ngModel)]="filters.source" type="search" placeholder="search on source" class="skill-search"/></td>
    </tr>
    <tr *ngFor="let wpn of wpnList$ | async
    |contains:'name': filters.name
    |contains:'damage': filters.damage
    |contains:'ammo': filters.ammo
    |filter:'category': filters.category
    |filter:'subcategory': filters.subcategory
    |sourcebookFilter:filters.source
    |filter:'type': filters.type
    |filter:'avail': filters.avail
    |filter:'conc': filters.conc
    |filter:'rel': filters.rel
    |orderby:sortOrder"
        style="vertical-align: top;">
        <td>{{wpn.category}}</td>
        <td>{{wpn.subcategory}}</td>
        <td>{{wpn.name | parse}}</td>
        <td>{{wpn.type}}</td>
        <td class="text-center">{{wpn.wa}}</td>
        <td class="text-center">{{wpn.conc}}</td>
        <td class="text-center">{{wpn.avail}}</td>
        <td class="text-center">{{wpn.damage}}</td>
        <td class="text-center">{{wpn.ammo? wpn.ammo :''}}</td>
        <td class="text-center">{{wpn.shots > 0 ? wpn.shots : ''}}</td>
        <td class="text-center">{{wpn.rof > 0 ? wpn.rof : ''}}</td>
        <td class="text-center">{{wpn.rel ? wpn.rel : ''}}</td>
        <td class="text-center">{{ wpn.thrown ? 'thrown' : ( wpn.range > 0 ? ((wpn.range | number) + 'm'): '')}}</td>
        <td class="text-center"><span *ngIf="wpn.cost > 0">{{wpn.cost|number}}eb</span></td>
        <td class="text-center">{{wpn.source.book |sourcebook}} pg. {{wpn.source.page}}</td>
    </tr>
  </table>
  </div>
